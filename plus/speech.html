<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
		<meta name="HandheldFriendly" content="true"/>
		<meta name="MobileOptimized" content="320"/>
		<title>Hello H5+</title>
		<script type="text/javascript" src="../js/common.js"></script>
		<script type="text/javascript">
var text=null;
function startRecognize() {
	if(plus.os.name=='Android'&&navigator.userAgent.indexOf('StreamApp')>0){
		plus.nativeUI.toast('当前环境暂不支持语音识别插件');
		return;
	}
	var options = {};
	options.engine = 'iFly';
	//options.punctuation = false;	// 是否需要标点符号 
	text.value = "";
	outSet( "开始语音识别：" );
	plus.speech.startRecognize( options, function ( s ) {
		outLine( s );
		text.value += s;
	}, function ( e ) {
		outSet( "语音识别失败："+e.message );
	} );
}
function startRecognizeEnglish(){
	if(plus.os.name=='Android'&&navigator.userAgent.indexOf('StreamApp')>0){
		plus.nativeUI.toast('当前环境暂不支持语音识别插件');
		return;
	}
	var options = {};
	options.engine = 'iFly';
	options.lang = 'en-us';
	text.value = "";
	outSet( "开始语音识别：" );
	plus.speech.startRecognize( options, function ( s ) {
		outLine( s );
		text.value += s;
	}, function ( e ) {
		outSet( "语音识别失败："+e.message );
	} );
}
		</script>
		<link rel="stylesheet" href="../css/mui.min.css" type="text/css" charset="utf-8"/>
		<link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8"/>
		<style type="text/css">
.out {
	margin: 9px;
	height: 30%;
	width: 90%;
}
		</style>
	</head>
	<body onload="text=document.getElementById('text');">
		<header class="mui-bar mui-bar-nav" >
			<button class=" mui-pull-left mui-btn-link mui-action-back setusercenter"><img src="../images/s2.png"></button>
			
			<h1 class="mui-title">语音识别</h1>
			<button class=" mui-pull-right mui-btn-link settingNew"><img src="../images/s1.png"></button> 

		</header>
		
		
		
		
		<div id="dcontent" class="dcontent">
			<br/>
			<div class="button" onclick="startRecognize()">开始语音识别</div>
			<br/>
			<div class="button" onclick="startRecognizeEnglish()">开始语音识别（英语）</div>
			<br/>
			<textarea readonly="readonly" id="text" style="margin:2%;padding:2%;height:50%;width:90%;border:1px solid #6C6C6C;-webkit-border-radius: 2px;border-radius: 2px;-webkit-appearance:none;">
语音输入内容
			</textarea>
		</div>
		<div id="output">
您可通过麦克风设备进行语音输入操作。
		</div>
	</body>
	<script type="text/javascript" src="../js/immersed.js" ></script>
	<script type="text/javascript" src="../js/jquery.min.js" ></script>
	<script type="text/javascript" src="../js/mui.min.js" ></script>
	<script type="text/javascript" src="../js/app.js" ></script>
	<script>
		
$(".settingNew").on("click", function() { 
				var state = app.getState();
				var isLogin = 0;
	            if(typeof(state.token) != "undefined")
	              {
		            isLogin = 1;
	              }
	              if(!isLogin)
	              {
	              	mui.openWindow({
			            url: '../login_new.html',
			            id: 'login_new'
		             });
	              	return;
	              }
			
				
				var url_setting = "../home.html";
				console.log("main to setting:" + url_setting);
		     	mui.openWindow({
		     		url: url_setting,
		     		id: "home",
		     		createNew: true
	     		});
	     	});
		
	</script>
</html>